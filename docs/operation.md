# Operation

The Enterprise Manager includes job subtype definitions for the Cegid ORLI Application. The job subtype can be accessed by selecting the Cegid ORLI job subtype from the drop down list when the Windows Job Type has been selected. 

## Cegid ORLI Job definitions
The Cegid ORLI Definition, defines various jobs that can be executed within the Cegid ORLI environment using the defined web services. 
These include requestFiles, requestLog, requestStatus, requestTechnicalData and executeRequest job types. 

When defining the Cegid ORLI job, first select a Job Type of Windows and then Cegid ORLI Job Subtype. The Cegid ORLI Definition screen will then appear.

The job definition consists of 2 separate areas, with a general area required by all Cegid ORLI jobs and specific information depending on the selected job type (requestFiles, requestLog, requestStatus, requestTechnicalData and executeRequest).
 
### General Information
 
The general area contains the following fields:

Field | Description
--------- | -----------
**User Id**          | Required field, defining the Windows batch user that the connector will be executed under.
**Connector Path**   | Required field that contains the installed location of the Cegid ORLI Connector. This consists of a global property value which contains the root installation directory. Default value is **OrliPath**. If more than one Orli Connectors is installed on the same system, then an additional global property should be defined and the entry in this field updated. 
**User Name v21.0.0**| Required field that contains the name of a Cegid user that has the required privileges to execute the job.
**User Name v22.0.0**| Value is maintained for compatibility reasons, but no longer used by the connector. Instead the user value in the configuration file used.
**Language Profile** | Optional field that contains the language to be used when generating information. This allows a different language to be used instead of the default language associated with the user profile. The value must be a defined value in the application.
**User Name**        | Required field that contains the  Cegid operation to execute. Select requestFiles, requestLog, requestStatus, requestTechnicalData or executeRequest from the drop down list. Depending which function is selected, additional information can be entered in the appropriate TAB definition.

### RequestFiles Cegid Operation Information 
 
The Request Files Used TAB is associated with the requestFiles job and is used to define the Request Number of a previously submitted executeRequest job. 
The requestFiles job retrieves a list of files generated by the executeRequest job. The information returned consists of a list of files and their locations so a user can display the generated files. The retrieved file list can be viewed using the OpCon JORS capability.

The **Request Files** Used TAB contains the following fields.

Field | Description
--------- | -----------
**Request Number**   | Required field that contains the number of a previously completed job executionRequest.

### RequestLog Cegid Operation Information 
 
The Request Log Information TAB is associated with the requestLog job and is used to define the Request Number of a previously submitted executeRequest job. 
The requestLog job retrieves the log files created during the executeRequest job. The information returned consists of the various log files generated by the job execution. The retrieved file list can be viewed using the OpCon JORS capability.

The **Request Log Information** TAB contains the following fields.

Field | Description
--------- | -----------
**Request Number**   | Required field that contains the number of a previously completed job executionRequest.

### RequestStatus Cegid Operation Information 
 
The Request Status TAB is associated with the requestStatus job and is used to define the Request Number of a previously submitted executeRequest job. 
The requestStatus job can be used to retrieve the status of an executeRequest job. The information returned consists of the status of the job.  It is a single check to determine the current status of a job. The failure criteria should be set to the expected value as successful completion. 

The **Request Status** TAB contains the following fields.

Field | Description
--------- | -----------
**Request Number**   | Required field that contains the number of a previously completed job executionRequest.

### RequestTechnicalData Cegid Operation Information 
 
The Request Technical Data TAB is associated with the requestTechnicalData job and is used to define the Request Number of a previously submitted executeRequest job. 
The requestTechnicalData job can be used to retrieve additional information about the executionRequest. This information is usually requested when failures occur when executing jobs and provides additional information for trouble shooting. The retrieved information can be viewed using the OpCon JORS capability.

The **Request Technical Data** TAB contains the following fields.

Field | Description
--------- | -----------
**Request Number**   | Required field that contains the number of a previously completed job executionRequest.

### ExecuteRequest Cegid Operation Information 
 
The Execute Request TAB is associated with the executeRequest job and is used to define the information required to execute a job within the Cegid ORLI environment. 

The **Execute Request** TAB contains the following fields.

Field | Description
--------- | -----------
**User Name v21.0.0**      | Required field that contains the name of a user that has the appropriate privileges to execute the job in the Cegid Application.
**User Name v22.0.0**      | Value is maintained for compatibility reasons, but no longer used by the connector. Instead the user value in the configuration file used.
**Func Name**              | Required field that contains the job to execute.
**Filter Name**            | Optional field that contains a filter defined by the user defining the output parameters associated with this request. If not present, the default value in the user profile defined for the User in the User Name field will be used.
**Extract Technical Data** | Optional field that when selected will retrieve the technical data of the job and add it to the job log.

### Failure Criteria Information

The requestFiles, requestLog, requestStatus, requestTechnicalData and executeRequest job types require a Failure Criteria definition. 
When the FINISHED_PROCESSING value is set the returned Cegid codes are mapped to either job JOB_FINISHED_OK, JOB_FINISHED_WITH_WARNING or JOB_FAILED.

Job Finished processing values

Code | TEXT | Description
---- | ----- | ------
**0**  |JOB_FINISHED_OK           |The job completed processing (FINISHED_PROCESSING value X and PROCESS_STATUS values 9 and LOG_STATUS 0.0).
**0**  |JOB_FINISHED_OK           |The job completed processing (FINISHED_PROCESSING value X and PROCESS_STATUS values 9 no LOG_STATUS present).
**1**  |JOB_FINISHED_WITH_WARNING |The job completed processing (FINISHED_PROCESSING value X and PROCESS_STATUS values 9 and LOG_STATUS 1.0).
**2**  |JOB_FAILED                |The job failed during processing (FINISHED_PROCESSING value X and PROCESS_STATUS values 9 and LOG_STATUS 2.0).
**6**  |JOB_FAILED                |The job failed (Cegid code 6 returned).
**7**  |JOB_DELETED               |The job was deleted (Cegid code 7 returned).
**8**  |JOB_STOPPED               |The job stopped (Cegid code 8 returned).
**99** |                          |Connection failure to Cegid Application, the connection to the Cegid application could not be established.


This means that to check for a successful completion, the Failure Criteria should be set to Equal To to 0 or Equal To 1 is Finish OK.

## Logging and Job Output
The default logging implemented by the connector consists of a maximum cycle of five log files. 
The log files contain information about the Cegid ORLI Connector and any jobs run by the Cegid ORLI Connector. The log files (cegidorli.log - cegidorli.log.5) are located in the installation root\\log directory. Information is appended into the log files and any error messages, return codes can be viewed in these log files.
